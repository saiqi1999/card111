# 场景文件夹 (Scenes)

此文件夹包含游戏中使用的所有场景文件。

## 文件结构

- `root.tscn` - 主场景，游戏的入口点
- `debug.tscn` - 调试场景，包含调试按钮和功能
- `card.tscn` - 卡牌场景，用于显示卡牌
- `ctrl.tscn` - 控制器场景，用于显示UI界面

## 场景说明

### 主场景 (Root)

`root.tscn` 是游戏的主场景，也是游戏启动时加载的第一个场景。目前包含以下节点：

- `Root` - 根节点（Node2D类型）
  - `Camera2D` - 相机节点，提供可拖拽和缩放的2D相机功能，附加了scripts/ctrl/camera_ctrl.gd脚本
  - `Debug` - 调试场景实例，作为子场景挂载在根节点下
  - `Util` - 工具节点，用于加载全局工具，附加了scripts/utils/global_util_loader.gd脚本

相机功能：
- **鼠标左键拖拽**：按住鼠标左键可拖拽移动相机视野
- **智能卡牌检测**：当鼠标位置有卡牌时，自动避免相机拖拽，优先处理卡牌操作
- **滚轮缩放**：使用鼠标滚轮进行相机缩放（0.5x-3.0x范围）
- **智能响应**：拖拽速度根据当前缩放级别自动调整
- **自动激活**：初始化时自动设置为当前活动相机

### 调试场景 (Debug)

`debug.tscn` 是一个调试工具场景，可以挂载在主场景中。包含以下节点：

- `Debug` - 根节点（Node2D类型）
  - `ButtonHandler` - 按钮和输入框事件处理节点，附加了scripts/debug/button_handler.gd脚本
  - `Button` - 按钮控件，位于屏幕右侧偏下位置，文本为"点击我"
  - `InputField` - 输入框控件，位于屏幕左侧偏下位置，用于接收文本输入

按钮的pressed信号已连接到ButtonHandler节点的_on_button_pressed方法。点击按钮时，会在root场景中创建三个不同位置的card场景实例，并通过类型字符串"strike"加载打击卡牌数据。

输入框的text_submitted信号已连接到ButtonHandler节点的_on_input_field_text_submitted方法。当在输入框中输入文本并按下回车键时，会触发文本提交事件。特别地：
- 当输入"hello"时，会打印特定的问候信息
- 当输入"reboot"时，会重启root节点，清除所有卡牌并重新初始化全局工具
- 当输入"slide"时，会创建一张从屏幕左侧滑动到中央的卡牌，并添加轻微的上下浮动动画
- 当输入"random"时，会创建一张卡牌并将其随机移动到非中心区域（X和Y坐标在-200到200范围内，但避开-50到50的中心区域）

### 卡牌场景 (Card)

`card.tscn` 是用于显示卡牌的场景。包含以下节点：

- `Card` - 根节点（Node2D类型），附加了scripts/cards/card_util.gd脚本
  - `Sprite2D` - 卡牌图像
  - `Label` - 卡牌名称标签
  - `Description` - 卡牌描述标签

卡牌场景可以通过以下方式加载数据：
1. `load_from_card_type("类型字符串")` - 通过类型字符串加载卡牌数据（推荐）
2. `load_from_card_pack(card_pack)` - 从卡包实例加载数据
3. `set_card_data(名称, 描述, 图像)` - 直接设置卡牌数据

### UI控制器系统

简化的UI控制器系统使用Autoload单例模式，无需场景文件。主要组件：

- `Ctrl400x300` - 信息面板Autoload单例，提供基本的标题和描述显示功能
- `CameraCtrl` - 相机控制器，提供拖拽和缩放功能

系统特性：
- **Autoload单例**：全局可访问，无需实例化
- **简化架构**：遵循Godot最佳实践，保持最小化
- **响应式布局**：自动适应窗口大小变化

```gdscript
# 显示信息面板
Ctrl400x300.show_ctrl()

# 设置显示内容
Ctrl400x300.set_ctrl_title_and_description("标题", "描述信息")

# 隐藏信息面板
Ctrl400x300.hide_ctrl()
```

## 场景设计

### 坐标系统

游戏使用Godot的2D坐标系统：
- 原点(0,0)位于屏幕左上角
- X轴向右为正方向
- Y轴向下为正方向

### 视口设置

游戏的视口大小设置为1920x1080像素，缩放比例为0.5，因此实际窗口大小为960x540像素。

## 开发指南

### 添加新场景

添加新场景时，请遵循以下规范：

1. 使用有意义的文件名，采用snake_case命名法
2. 为主要节点添加有意义的名称
3. 相关功能的场景应放在同一个子文件夹中
4. 如果创建新的场景类型，请创建相应的子文件夹

### 场景组织

- 使用节点组织场景层次结构
- 使用信号连接节点之间的交互
- 尽量将UI元素与游戏逻辑分离
- 使用脚本扩展场景功能
